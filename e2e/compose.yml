services:
  server:
    container_name: server
    networks:
      - default
    build:
      context: server
      dockerfile: Dockerfile

    healthcheck:
      test: ["CMD", "./healthcheck.sh"]
      interval: 3s
      timeout: 5s
      retries: 5
      start_period: 2s

  e2e:
    container_name: e2e_tests
    networks:
      - default
    build:
      context: ../
      dockerfile: e2e/Dockerfile
    depends_on:
      server:
        condition: service_healthy

networks:
  default:
    driver: bridge
